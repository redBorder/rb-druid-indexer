zookeeper_servers:
  - "zookeeper1.service:2181"
  - "zookeeper2.service:2181"

tasks:
  - task_name: "rb_monitor"
    feed: "rb_monitor"
    spec: "rb_monitor"
    kafka_brokers:
      - "rb-malvarez1.node:9092"
      - "rb-malvarez2.node:9092"
    dimensions_exclusions:
        - "unit"
        - "type"
        - "value"
    metrics:
        - type: count
          name: events
        - type: doubleSum
          name: sum_value
          fieldName: value
        - type: doubleMax
          name: max_value
          fieldName: value
        - type: doubleMin
          name: min_value
          fieldName: value
  - task_name: "rb_state"
    feed: "rb_state_post"
    spec: "rb_state"
    kafka_brokers:
      - "rb-malvarez1.node:9092"
      - "rb-malvarez2.node:9092"
    dimensions:
        - "wireless_station"
        - "type"
        - "wireless_channel"
        - "wireless_tx_power"
        - "wireless_admin_state"
        - "wireless_op_state"
        - "wireless_mode"
        - "wireless_slot"
        - "sensor_name"
        - "sensor_uuid"
        - "deployment"
        - "deployment_uuid"
        - "namespace"
        - "namespace_uuid"
        - "organizaton"
        - "organization_uuid"
        - "market"
        - "market_uuid"
        - "floor"
        - "floor_uuid"
        - "zone"
        - "zone_uuid"
        - "building"
        - "building_uuid"
        - "campus"
        - "campus_uuid"
        - "service_provider"
        - "service_provider_uuid"
        - "wireless_station_ip"
        - "status"
        - "wireless_station_name"
        - "client_count"
    metrics:
        - type: count
          name: events
        - type: doubleSum
          name: sum_value
          fieldName: value
        - type: hyperUnique
          name: wireless_stations
          fieldName: wireless_station
        - type: hyperUnique
          name: wireless_channels
          fieldName: wireless_channel
        - type: longSum
          name: sum_wireless_tx_power
          fieldName: wireless_tx_power
  - task_name: "rb_flow"
    feed: "rb_flow_post"
    spec: "rb_flow"
    kafka_brokers:
      - "rb-malvarez1.node:9092"
      - "rb-malvarez2.node:9092"
    dimensions:
        - "application_id_name"
        - "building"
        - "building_uuid"
        - "campus"
        - "campus_uuid"
        - "client_accounting_type"
        - "client_auth_type"
        - "client_fullname"
        - "client_gender"
        - "client_id"
        - "client_latlong"
        - "client_loyality"
        - "client_mac"
        - "client_mac_vendor"
        - "client_rssi"
        - "client_vip"
        - "conversation"
        - "coordinates_map"
        - "deployment"
        - "deployment_uuid"
        - "direction"
        - "dot11_protocol"
        - "dot11_status"
        - "dst_map"
        - "duration"
        - "engine_id_name"
        - "floor"
        - "floor_uuid"
        - "host"
        - "host_l2_domain"
        - "http_social_media"
        - "http_user_agent"
        - "https_common_name"
        - "interface_name"
        - "ip_as_name"
        - "ip_country_code"
        - "ip_protocol_version"
        - "l4_proto"
        - "lan_interface_description"
        - "lan_interface_name"
        - "lan_ip"
        - "lan_ip_as_name"
        - "lan_ip_country_code"
        - "lan_ip_name"
        - "lan_ip_net_name"
        - "lan_l4_port"
        - "lan_name"
        - "lan_vlan"
        - "market"
        - "market_uuid"
        - "namespace"
        - "namespace_uuid"
        - "organization"
        - "organization_uuid"
        - "product_name"
        - "public_ip"
        - "public_ip_mac"
        - "referer"
        - "referer_l2"
        - "scatterplot"
        - "selector_name"
        - "sensor_ip"
        - "sensor_name"
        - "sensor_uuid"
        - "service_provider"
        - "service_provider_uuid"
        - "src_map"
        - "tcp_flags"
        - "tos"
        - "type"
        - "url"
        - "wan_interface_description"
        - "wan_interface_name"
        - "wan_ip"
        - "wan_ip_as_name"
        - "wan_ip_country_code"
        - "wan_ip_map"
        - "wan_ip_net_name"
        - "wan_l4_port"
        - "wan_name"
        - "wan_vlan"
        - "wireless_id"
        - "ti_category"
        - "ti_average_score"
        - "ti_policy_name"
        - "ti_policy_id"
        - "ti_indicators"
        - "wireless_operator"
        - "wireless_station"
        - "zone"
        - "zone_uuid"
        - "client_asset_type"
    dimensions_exclusions:
        - "bytes"
        - "pkts"
        - "flow_end_reason"
        - "first_switched"
        - "wan_ip_name"
    metrics:
        - type: count
          name: events
        - type: longSum
          name: sum_bytes
          fieldName: bytes
        - type: longSum
          name: sum_pkts
          fieldName: pkts
        - type: longSum
          name: sum_rssi
          fieldName: client_rssi_num
        - type: hyperUnique
          name: clients
          fieldName: client_mac
        - type: hyperUnique
          name: wireless_stations
          fieldName: wireless_station
  - task_name: "rb_event"
    feed: "rb_event_post"
    spec: "rb_event"
    kafka_brokers:
      - "rb-malvarez1.node:9092"
      - "rb-malvarez2.node:9092"
    dimensions:
        - "src"
        - "src_is_malicious"
        - "dst"
        - "dst_is_malicious"
        - "sensor_uuid"
        - "src_port"
        - "dst_port"
        - "src_as_name"
        - "src_country_code"
        - "dst_map"
        - "src_map"
        - "service_provider"
        - "sha256"
        - "sha256_is_malicious"
        - "file_uri"
        - "file_uri_is_malicious"
        - "file_size"
        - "file_hostname"
        - "file_hostname_is_malicious"
        - "action"
        - "ethlength_range"
        - "icmptype"
        - "ethsrc"
        - "ethsrc_vendor"
        - "ethdst"
        - "ethdst_vendor"
        - "ttl"
        - "vlan"
        - "classification"
        - "domain_name"
        - "group_name"
        - "sig_generator"
        - "rev"
        - "priority"
        - "msg"
        - "sig_id"
        - "dst_country_code"
        - "dst_as_name"
        - "namespace"
        - "deployment"
        - "market"
        - "organization"
        - "campus"
        - "building"
        - "floor"
        - "floor_uuid"
        - "conversation"
        - "iplen_range"
        - "l4_proto"
        - "sensor_name"
        - "scatterplot"
        - "src_net_name"
        - "dst_net_name"
        - "tos"
        - "service_provider_uuid"
        - "namespace_uuid"
        - "market_uuid"
        - "organization_uuid"
        - "campus_uuid"
        - "building_uuid"
        - "deployment_uuid"
        - "incident_uuid"
        - "event_uuid"
    dimensions_exclusions:
        - "payload"
    metrics:
        - type: count
          name: events
        - type: hyperUnique
          name: signatures
          fieldName: msg
  - task_name: "rb_vault"
    feed: "rb_vault_post"
    spec: "rb_vault"
    kafka_brokers:
      - "rb-malvarez1.node:9092"
      - "rb-malvarez2.node:9092"
    dimensions:
        - "pri"
        - "pri_text"
        - "syslogfacility"
        - "syslogfacility_text"
        - "syslogseverity"
        - "syslogseverity_text"
        - "hostname"
        - "fromhost_ip"
        - "app_name"
        - "sensor_name"
        - "proxy_uuid"
        - "message"
        - "status"
        - "ti_category"
        - "ti_average_score"
        - "ti_policy_name"
        - "ti_policy_id"
        - "ti_indicators"
        - "category"
        - "source"
        - "target"
        - "sensor_uuid"
        - "service_provider"
        - "service_provider_uuid"
        - "namespace"
        - "namespace_uuid"
        - "deployment"
        - "deployment_uuid"
        - "market"
        - "market_uuid"
        - "organization"
        - "organization_uuid"
        - "campus"
        - "campus_uuid"
        - "building"
        - "building_uuid"
        - "floor"
        - "floor_uuid"
        - "action"
        - "incident_uuid"
        - "alarm_id"
        - "alarm_name"
        - "alarm_product_type"
        - "alarm_condition"
        - "alarm_user"
        - "alarm_severity"
        - "lan_ip"
        - "wan_ip"
        - "wireless_station"
        - "asset_ip_address"
        - "asset_mac_address"
        - "client_mac"
        - "ethdst"
        - "ethsrc"
    dimensions_exclusions:
        - "unit"
        - "type"
        - "valur"
    metrics:
        - type: count
          name: events
  - task_name: "rb_scanner"
    feed: "rb_scanner_post"
    spec: "rb_scanner"
    kafka_brokers:
      - "rb-malvarez1.node:9092"
      - "rb-malvarez2.node:9092"
    dimensions:
        - "pri"
        - "pri_text"
        - "syslogfacility"
        - "syslogfacility_text"
        - "syslogseverity"
        - "syslogseverity_text"
        - "hostname"
        - "fromhost_ip"
        - "app_name"
        - "sensor_name"
        - "proxy_uuid"
        - "message"
        - "status"
        - "category"
        - "source"
        - "target"
        - "sensor_uuid"
        - "service_provider"
        - "service_provider_uuid"
        - "namespace"
        - "namespace_uuid"
        - "deployment"
        - "deployment_uuid"
        - "market"
        - "market_uuid"
        - "organization"
        - "organization_uuid"
        - "campus"
        - "campus_uuid"
        - "building"
        - "building_uuid"
        - "floor"
        - "floor_uuid"
        - "ipaddress"
        - "scan_id"
        - "scan_subtype"
        - "scan_type"
        - "result_data"
        - "result"
        - "cve_info"
        - "vendor"
        - "product"
        - "version"
        - "servicename"
        - "protocol"
        - "cpe"
        - "cve"
        - "port"
        - "metric"
        - "severity"
        - "score"
        - "mac"
        - "subnet"
        - "path"
        - "layer"
        - "ipv4"
        - "port_state"
    metrics:
        - type: count
          name: events
  - task_name: "rb_location"
    feed: "rb_loc_post"
    spec: "rb_location"
    kafka_brokers:
      - "rb-malvarez1.node:9092"
      - "rb-malvarez2.node:9092"
    dimensions:
        - "location_id"
        - "latitude"
        - "longitude"
        - "address"
        - "city"
        - "region"
        - "country"
        - "postal_code"
        - "sensor_name"
        - "sensor_uuid"
        - "deployment"
        - "deployment_uuid"
        - "namespace"
        - "namespace_uuid"
        - "organization"
        - "organization_uuid"
        - "market"
        - "market_uuid"
        - "floor"
        - "floor_uuid"
        - "zone"
        - "zone_uuid"
        - "building"
        - "building_uuid"
        - "campus"
        - "campus_uuid"
        - "service_provider"
        - "service_provider_uuid"
    metrics:
        - type: count
          name: events
        - type: doubleSum
          name: sum_latitude
          fieldName: latitude
        - type: doubleSum
          name: sum_longitude
          fieldName: longitude
        - type: hyperUnique
          name: unique_locations
          fieldName: location_id
  - task_name: "rb_wireless"
    feed: "rb_wireless"
    spec: "rb_wireless"
    kafka_brokers:
      - "rb-malvarez1.node:9092"
      - "rb-malvarez2.node:9092"
    dimensions:
        - "wireless_station"
        - "type"
        - "wireless_channel"
        - "wireless_tx_power"
        - "wireless_admin_state"
        - "wireless_op_state"
        - "wireless_mode"
        - "wireless_slot"
        - "sensor_name"
        - "sensor_uuid"
        - "deployment"
        - "deployment_uuid"
        - "namespace"
        - "namespace_uuid"
        - "organization"
        - "organization_uuid"
        - "market"
        - "market_uuid"
        - "floor"
        - "floor_uuid"
        - "zone"
        - "zone_uuid"
        - "building"
        - "building_uuid"
        - "campus"
        - "campus_uuid"
        - "service_provider"
        - "service_provider_uuid"
        - "wireless_station_ip"
        - "status"
        - "wireless_station_name"
        - "client_count"
    metrics:
        - type: count
          name: events
        - type: hyperUnique
          name: wireless_stations
          fieldName: wireless_station
        - type: hyperUnique
          name: wireless_channels
          fieldName: wireless_channel
        - type: longSum
          name: sum_wireless_tx_power
          fieldName: wireless_tx_power
